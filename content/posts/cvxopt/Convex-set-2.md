---
title: "Convex Set —— 续"
date: 2022-01-01
draft: false
slug: convex-set-2
categories: ["运筹与优化", "凸优化"]
tags: []
# 四个大类: 分析与概率, 算法与程序设计, 运筹与优化, 论文简读
---

这是 convex set 的第二部分

---


## 仿射无关 (affinely independent)

定义 $x_{1}, x_{2}, \ldots, x_{k}$ 仿射无关，当且仅当 $x_{2}-x_{1}, \ldots, x_{k}-x_{1}$ 线性无关。否则就称是仿射相关的。

关于仿射更多的性质：

+ $x_{0}+\operatorname{span}\left\{x_{1}-x_{0}, \ldots, x_{k}-x_{0}\right\}=\operatorname{aff}\left\{x_{0}, \ldots, x_{k}\right\}$
+ $\left\{x_{0}, \ldots, x_{k}\right\}$ 包含 $0 \Rightarrow \operatorname{aff}\left\{x_{0}, \ldots, x_{k}\right\}=\operatorname{span}\left\{x_{0}, \ldots, x_{k}\right\}$
+ 线性无关的向量组也是仿射无关的
+ 如果 $x_1, x_2, \dots, x_k$ 仿射无关，那么 $0=\sum_{i=0}^{k} \alpha_{i} x_{i}, 0=\sum_{i=0}^{k} \alpha_{i}$ 有唯一解 $\alpha_{0}=\alpha_{1}=\cdots=\alpha_{k}=0$


## 仿射变换 (affine transformation)

仿射变换是指满足以下条件的函数：

$$
F(\lambda x+(1-\lambda) y)=\lambda F(x)+(1-\lambda) F(y), \quad \lambda \in \mathrm{R}
$$

一些性质：

+ 对于仿射变换 $F$， $T(x) = F(x) - F(0)$ 是线性变换。
+ 如果 $S$ 是仿射集，那么 $F(S)$ 也是仿射集，即仿射集在仿射变换的作用下也是仿射的。
+ $F(\operatorname{aff} M)=\operatorname{aff}(F(M))$


## 包算子 (Closure operator)

In mathematics, a closure operator on a set $S$ is a function $\mathrm{cl}: \mathcal{P}(S) \rightarrow \mathcal{P}(S)$ from the power set of $S$ to itself that satisfies the following conditions for all sets $X, Y \subseteq S$

$$
\begin{array}{ll}
& X \subseteq \operatorname{cl}(X) \quad & \text{(cl is extensive)} \\
& X \subseteq Y \Rightarrow \operatorname{cl}(X) \subseteq \operatorname{cl}(Y) \quad & \text{(cl is monotone)} \\ 
& \operatorname{cl}(\operatorname{cl}(X))=\operatorname{cl}(X) \quad & \text {(cl is idempotent) }
\end{array}
$$

Closure operators are also called "**hull operators**".

闭包算子是集合到集合的映射，满足扩展性、单调性、幂等性。

这是一个拓扑学的概念，最简单的例子，就是欧式空间中的闭包。

一个拓扑空间可以很容易地引出一个闭包算子。

容易验证，affine hull、convex hull、conic hull 是包算子。

## Topological properties of convex sets

凸集有很好的拓扑性质。

+ $C$ 是凸集 $\Longrightarrow \operatorname{int} C$ 和 $\operatorname{cl} C$ 都是凸的

+ $C$ 是紧的 $\Longrightarrow \operatorname{conv} C$ 也是紧的 （$\operatorname{conv} C$ 的任意点列都有收敛子列）
+ $C$ 有界 $\Longrightarrow \operatorname{cl} C$ 是紧集  $\Longrightarrow\operatorname{conv} C$ 是紧集


包算子 $\operatorname{conv}$ 保持紧性，但是不保持闭性（$x^2y=1$ 的函数图像的凸包是一个开集），除非集合有界。

由此可定义闭凸包算子 
$$
\overline{\operatorname{conv}} S := \bigcap_{\begin{array}{c} &S \subset U \\ &S \text{ closed} \end{array} } U = \operatorname{cl} (\operatorname{conv} S)
$$

对于非空集合 $S$

+ $\overline{\operatorname{conv}} S=\operatorname{cl}(\operatorname{conv} S)$
+ 如果 $S$ 有界，那么 $\overline{\operatorname{conv}} S=\operatorname{conv}(\operatorname{cl} S)=\operatorname{cl}(\operatorname{conv} S)$


## Relative topology

如果一个凸集 $C$ 有内点，那么 $C$ 的仿射包一定是全空间。但是，比如说三维空间中的一张纸，它在 $\mathrm{R}^3$ 不存在内点，但是在二维空间中，却是有内点的。

相对内点(相对拓扑)的概念就是为了处理这种问题的。相对内点的定义是：

$$
\operatorname{ri} C=\{x \in C \mid B(x, r) \cap \text { aff } C \subseteq C \;\text { for some } r>0\}\\
$$

**“相对”二字指的是相对凸集的仿射包**。

常见集合的相对内点：

| $C$  |$\operatorname{aff} C$|$\operatorname{dim} C$ | $\operatorname{ri} C$ |
| :--: | :--: | :--: | :--: |
| $\{x\}$ | $\{x\}$ | $0$ | $\{x\}$ |
| $[a, b]$ | line generated by $a$ and $b$ | $1$ | $(a, b)$ |
| $B(x, r)$ | $\mathrm{R}^n$ | $n$ | $\operatorname{int} B(x, r)$ |

相对内点并不是一个单调的操作， $A \subseteq B$ 并不意味着 $\operatorname{ri} A \subseteq \operatorname{ri} B$ . 如 $\{0\}$ 和 $[0, 1]$ .

由相对内点可以引出相对闭包：
$$
\operatorname{rbd} C = \operatorname{cl} C \backslash \operatorname{ri} C
$$
相对内点对凸集十分重要，因为**非空的凸集必然存在相对内点**。


对凸集而言

+ $\operatorname{aff}(\mathrm{cl} C)=\operatorname{aff} C=\operatorname{aff}(\operatorname{ri} C)$
+ $\mathrm{ri}(\mathrm{ri} C)=\operatorname{ri} C=\operatorname{ri}(\operatorname{cl} C)$
+ $\mathrm{cl} C=\mathrm{cl}(\mathrm{ri} C)$
+ $\operatorname{rbd} C=\operatorname{rbd}(\operatorname{ri} C)=\operatorname{rbd}(\operatorname{cl} C)$
+ $F(\operatorname{ri} C) = \operatorname{ri} F(C)$  for any affine map $F$



如果两个凸集 $C_1, C_2$ 满足 $\operatorname{ri} C_1 \cap \operatorname{ri} C_2 \neq \emptyset$，那么：

$$
\begin{aligned}
\operatorname{ri}\left(C_{1} \cap C_{2}\right) &=\operatorname{ri} C_{1} \cap \operatorname{ri} C_{2} \\
\operatorname{cl}\left(C_{1} \cap C_{2}\right) &=\operatorname{cl} C_{1} \cap \operatorname{cl} C_{2} \\
\operatorname{ri}\left(C_{1}+C_{2}\right)&=\operatorname{ri} C_{1}+\operatorname{ri} C_{2} \\
\end{aligned}
$$




**Line segment principle**

If $C$ is a convex set, $x \in \operatorname{ri}(C)$ and $\bar{x} \in \operatorname{cl}(C)$, then all points on the line segment connecting $x$ and $\bar{x}$, except possibly $\bar{x}$, belong to $\operatorname{ri}(C)$ .

**Prolongation Lemma / Stretching principle**

$x \in \operatorname{ri}(C)$ if and only if every line segment in $C$ having $x$ as one endpoint can be prolonged beyond $x$ without leaving $C$.

i.e, if $C$ convex
$$
x \in \operatorname{ri} C \Leftrightarrow \forall z \in C, \exists \mu>1, \mu x+(1-\mu) z \in C .
$$


## 凸集的表示

**Caratheodory’s theorem**：

$S$ 是 $\mathrm{R}^n$ 的子集，那么， $x \in \operatorname{conv} S$，当且仅当存在一个至多包含 $S$ 中 $n+1$ 个点的 $A \subset S$，使得 $x$ 是 $A$ 中点的凸组合。

这个定理反过来是显然的，如果 $x$ 是 $A$ 中点的凸组合，那么必然 $x \in \operatorname{conv} S$。

现在设 $x \in \operatorname{conv} S$，那么根据凸包的定义，不妨设存在 $k > n, \lambda _i > 0$，使得 $x = \sum_{i=0}^k \lambda_i x_i$， 现在 $x_i - x_0 \: (1 \leq i \leq k)$ 这超过 $n$ 个的向量族必然是线性相关的，这样就可以采用线性相关的定义来证明 $x$ 只需要用 $k-1$ 个点的凸组合来表示就行了。

例：设 $S = \{(0, 0), (0, 1), (1, 1), (1,0)\}$，$S$ 表示的是单位正方形的四个点，$\operatorname{conv} S$ 就是一个单位正方形。在这个单位正方形里随便取一个点，总能找到由 $S$ 中三个点组成的三角形覆盖住这个点。

关于 $\operatorname{coni} S$ 成立一个类似的定理，只不过点数从 $n+1$ 减少到了 $n$ 个。

**W. Fenchel and L. Bunt**：

如果 $S \subset \mathrm{R}^n$ 是一个**连通**的凸集，则 $x \in \operatorname{conv} S$ 可以被表示成 $S$ 中 $n$ 个点的凸组合；这个结论可以被放宽至 $S$ 有不超过 $n$ 个连通分量。


**Minkowski and Weyl**：polyhedron representation

有界多面体可由其极点唯一决定。对于无界的多面体，可以由极点和方向来决定（extreme points and extreme rays）。

这写下来就是：对任何 $P = \{x \mid Ax \leq b\}$，总能找到两个点集 $V, R$ ，使得：

$$
P = \operatorname{conv}(V) + \operatorname{coni}(R)\\
$$

也就是说，多面体可以表示成一个凸集和一个锥的 Minkowski sum。这个定理在一些教材中也叫做 resolution theorem.


## 几类重要的锥

### Polar cone

对于凸锥来说，非常有意义的一点是，它可以认为是介于 subspace 与 general convex set 之间的产物。

锥 $K$ 的极锥定义为：
$$
K^{\circ}=\left\{s \in \mathbb{R}^{n}:\langle s, x\rangle \leqslant 0 \text { for all } x \in K\right\}
$$
如果 $K$ 是一个超平面，那么 $K^\circ = K^\perp$ . 实际上，极锥就可以看成是正交补的推广。

<img src="../figures/Convex-set-2/image-20220321163212889.png" alt="image-20220321163212889" style="zoom:60%;" />

注意到极锥一定是闭凸锥；$K^\circ = - K ^\ast$

极运算是反序的，如果锥 $K_1 \subseteq K_2$，那么 $K_2^\circ \subseteq K_1^\circ$ .



对一个任意的集合 $C$，它边界点 $x_0$ 的 **normal cone** 指的是集合 $\{y \mid y^T (x - x_0) \leq 0,\; \forall x \in C\}$。即 $y$ 与任何以 $x_0$ 为端点的线段都不构成锐角。不论集合 $C$ 是什么，它的 normal cone 都是一个凸锥！

对一个任意的集合 $C$，它的 **barrier cone** 被定义为集合 $\{y \mid |y^T x| < +\infty, \; \forall x \in C\}$。即非零向量 $y$ 是包含 $C$ 的半平面 $\{x \mid y^T x \leq \alpha\}$ 的法向。不论集合 $C$ 是什么，它的 barrier cone 也是一个凸锥！

对一个任意的集合 $C$，它的 **recession cone** 被定义为集合 $\{y \mid x - ty \in C, \;  \forall x \in C, \; \forall t \geq 0\}$。$C$ 的回收锥可以理解为是 $C$ 内所有可以无限延伸的方向生成的锥。凸集的 recession cone 是一个凸锥；特别地，多面体 $\{x \mid Ax = b\}$ 的 recession cone 是 $\{y \mid Ay=0\}$。

如果 $C$ 是一个非空的闭凸集，那么 $C$ 的 recession cone 是它的 barrier cone 的对偶锥。

polar cone


## 近似的凸集表示定理

> HDP

## 对偶范数的进一步理解

当我们在研究 $X = \mathrm{R}^n$ 的时候（此时没有引入范数），我们会发现 $\mathrm{R}^n$ 的对偶空间 $X^\ast$ 和 $\mathrm{R}^n$ 是线性同构的（只需要纯代数的证明），如果我们在 $\mathrm{R}^n$ 中引入范数，那么它的对偶空间的元素，也会有随之定义的算子范数，**这个对偶空间里的算子范数就是对偶范数**！

在 $\mathrm{R}^n$ 空间中，范数 $\| \cdot \|$ 的对偶范数被定义为：

$$
\|z\|_{\ast}=\sup \left\{z^{T} x \mid\|x\| \leq 1\right\} \\
$$

我们知道 $(\mathrm{R}^n, \|\cdot \|)$ 是一个 Banach space，该空间上每一个元素 $z$ 都能诱导出一个 linear functional：

$$
f_z(x) = z^T x \\
$$

这个 linear functional $f_z$ 的算子范数就是 $z$ 的对偶范数！所以，**$(\mathrm{R}^n, \| \cdot \|)$ 的对偶空间是 $(\mathrm{R}^n, \|\cdot \|_\ast)$**。

> $\mathrm{R}^n$ 上的所有线性泛函都具有形式：$f(x) = a^T x$. 
>
> 见：https://math.stackexchange.com/questions/3377554/show-that-any-linear-function-f-mathbbrn-to-mathbbr-is-of-the-form-fx

根据对偶范数的定义可以得到不等式：

$$
\|x \| \cdot \|z\|_\ast \leq |x^T z| \\
$$

在矩阵空间 $\mathrm{R}^{m\times n}$ 上，类似的，有限维线性空间与其对偶空间都是线性同构的，假如我们在 $\mathrm{R}^{m\times n}$ 引入谱范数（spectrum norm），即矩阵最大的奇异值，类似可以在矩阵空间上构造线性泛函：

$$
f_Z (X) = \operatorname{tr}(Z^T X) \\
$$

这个由矩阵 $Z$ 诱导出的线性泛函，它的算子范数：

$$
\|Z\|_{2 *}=\sup \left\{\operatorname{tr}\left(Z^{\top} X\right) \mid\|X\|_{2} \leq 1\right\} = \sum_i\sigma_i(Z) \\
$$

就是核范数（nuclear norm），即矩阵所有奇异值的和。


## 支撑函数

一个集合 $C$ 的支撑函数（support function）定义为：

$$
S_C(y) = \sup\, \{y^Tx \mid x \in C\}
$$

容易看到，支撑函数是一个齐次函数（homogeneous），并且不论集合 $C$ 是什么，$S_C$ 都是凸函数！

例子：

+ 单点集 $\{a_0\}$ 的支撑函数是 $S(y) = a_0^T y$
+ 半径为 1 的单位球的支撑函数是 $S(y) = \| y\|_2$
+ $\mathcal{U} = \{x \mid \| x - \mu \| \leq 1\}$ 的支撑函数是 $S_{\mathcal{U}} (y) = y^T \mu + \| y\|_\ast$ （这个在鲁棒优化里面有应用）


下面这个定理说明，一个闭凸集被它的支撑函数完全刻画：

**如果 $C$ 和 $D$ 是闭凸集，那么 $C = D$ 当且仅当 $S_C = S_D$**。

假如 $S_C = S_D$，先证明 $D \subseteq C$；假如说存在一点 $x_0 \in D, x_0 \notin C$，因为 $C$ 是闭集，而闭集和闭集外一点是可以找到超平面严格分割的，于是，存在 $a \neq 0$，使得 $a^T x_0 > b$，且 $a^T x < b, \,\forall x  \in C$，这意味着：

$$
\sup _{x \in C} a^{T} x \leq b<a^{T} x_{0} \leq \sup _{x \in D} a^{T} x \\
$$

与 $S_C = S_D$ 矛盾，这就证明了 $D \subseteq  C$，于是 $D=C$。

### 支撑函数的几何意义

<img src="../figures/Convex-Set/convex-optimization-theory-support.png" alt="support function" style="zoom:67%;" />



对于每一个 $a \in \mathrm{R}^n$ ，借助支撑函数都能找到包含 $C$ 的一个支撑超平面：

$$
H_a = \{ y \mid  y^T a \leq S_C(a)\} \\
$$

这个超平面以 $a$ 为法向量。

在上图中 $y$ 引出的支撑超平面就是虚线标的那条。

**利用支撑函数可以证明，一个闭凸集等于它所有的支撑半平面的交集。**

