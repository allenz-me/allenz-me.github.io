---
title: "次梯度与次梯度方法"
date: 2022-03-04
draft: false
toc: false
slug: subgrad
categories: ["运筹与优化"]
tags: ["Subgradient"]
# 四个大类: 分析与概率, 算法与程序设计, 运筹与优化, 论文简读
---


### 次梯度 subgradient

当优化问题的目标函数不可微的时候，我们就会去考虑梯度的替代品：**次梯度**。

一些目标函数不可微的凸优化问题，就可以使用次梯度方法来求解。

凸函数有一个很好的性质，那就是任意一点的切平面都位于函数图形的下方。对于凸函数 $f$，如果

$$
f(y) \\geq f(x)\+g^{T}(y\-x) \\quad \\text{for all } y \\tag{1}
$$

就说 $g$ 是 $x$ 这点的次梯度。

函数的梯度是一个向量，注意次梯度方向可能不唯一，所有次梯度构成的集合叫做**次微分(subdifferential)**，$x$ 的次微分记作 $\\partial f(x)$。

在上面的定义下，凸函数的次微分总是非空，凹函数的次微分是空集。类似地，把式(1)的不等号方向改变可以得到对于凹函数的次微分的定义。

如果要把次梯度的概念推广到一般函数的话，那么会发现，一般函数可能再某个点不存在次梯度（次梯度为空集），而凸函数不会存在这样的问题。在凸函数的定义域的**相对内点集**上，次梯度集总是非空（凸函数在定义域的边界的连续性比较复杂）。

以一维为例，$f$ 在 $x\_0$ 不一定可导，但是有左导数 $a$，右导数 $b$，那么 $[a,b]$ 就是 $f$ 在 $x\_0$ 这点的次微分。比如 $f=|x|$ 在 $x=0$ 处的次微分就是 $[\-1, 1]$。

**通过次梯度可以得到一个函数（不管是不是凸的）全局最优解的性质。** 如果 $0\\in \\partial f(x^\ast)$，那么 $x^\ast$ 就是全局最小点。


### 次梯度方法

次梯度方法就是沿着次梯度的方向进行迭代的方法。如：

$$
\\max\_x f(x) = \\max\_x \\: \\min\_{i=1\\dots n} \\; a\_i^T x \+ b\_i
$$

目标函数是分段线性的凹函数，在若干点是不可微的，但是可以计算到 $f(x)$ 的次梯度，令 $I(x^\\ast) = \\{i \\mid f(x^\\ast) = a\_i^T x^\\ast \+ b\_i \\}$，则

1. $a\_i \\in \\partial f(x^\\ast) \\;\\; \\text{for all }\\; i \\in I$
2. $\\partial f(x^\\ast) = \\left\\{s \\in \\mathrm{R}^{n}\\mid  s=\\Sigma\_{i \\in I\\left(x^{\ast}\\right)} \\lambda\_{i} a^{i}, \\Sigma\_{i \\in I\\left(x^{\ast}\\right)} \\lambda\_{i}=1, \\lambda\_{i} \\geq 0 \\text { for } i \\in I\\left(x^{\ast}\\right)\\right\\}$

由此可以用次梯度方法来求解。

参考：
[【凸优化笔记5】-次梯度方法（Subgradient method）
](https://zhuanlan.zhihu.com/p/103359560)

